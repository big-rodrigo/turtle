# Datasource
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${DB_USER:turtle}
quarkus.datasource.password=${DB_PASSWORD:turtle}
quarkus.datasource.jdbc.url=jdbc:postgresql://${DB_HOST:localhost}:5432/${DB_NAME:turtle_db}

# Hibernate — Flyway owns the schema; Hibernate validates
quarkus.hibernate-orm.database.generation=validate
quarkus.flyway.migrate-at-start=true

# JWT signing (PKCS#8 private key) and verification (public key)
# Run once: openssl genrsa -out private.pem 2048
#           openssl pkcs8 -topk8 -nocrypt -inform PEM -outform PEM -in private.pem -out privateKey.pem
#           openssl rsa -in private.pem -pubout -outform PEM -out publicKey.pem
smallrye.jwt.sign.key.location=privateKey.pem
mp.jwt.verify.publickey.location=publicKey.pem
mp.jwt.verify.issuer=turtle-api

# Evolution API (WhatsApp notifications)
quarkus.rest-client.evolution-api.url=${EVOLUTION_API_URL:http://localhost:8081}
evolution.api.key=${EVOLUTION_API_KEY:changeme}
evolution.api.instance=${EVOLUTION_API_INSTANCE:turtle}

# Email notifications (SMTP)
# Dev default: Mailpit (no auth, plain SMTP on port 1025)
# Prod: override MAIL_* env vars to point at Mailcow
quarkus.mailer.host=${MAIL_HOST:localhost}
quarkus.mailer.port=${MAIL_PORT:1025}
quarkus.mailer.start-tls=${MAIL_STARTTLS:DISABLED}
quarkus.mailer.username=${MAIL_USER:}
quarkus.mailer.password=${MAIL_PASSWORD:}
quarkus.mailer.from=${MAIL_FROM:notifications@turtle.local}
quarkus.mailer.mock=false
# Test profile — use MockMailbox so no real SMTP is needed in unit tests
%test.quarkus.mailer.mock=true

# Jackson — ISO-8601 dates instead of timestamps
quarkus.jackson.serialization.write-dates-as-timestamps=false

# Admin provisioning — set ADMIN_PROVISIONING_TOKEN in the environment to enable admin creation
turtle.admin.provisioning-token=${ADMIN_PROVISIONING_TOKEN:}
